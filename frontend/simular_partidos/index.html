<!DOCTYPE html>
<html lang="en">
<head>
    <title>Dream Team</title>
    <style>
        body{
            background: url(../fondo_pasto.jpg) no-repeat center center fixed;
            background-size: cover;
            margin: auto;
            font-family: Tahoma, Geneva, sans-serif;
        }
        header{
            display: flex;
            align-items: center;
            background-color: rgba(0, 0, 0, 0.637);
            justify-content: space-between;
            padding-bottom: 2%;
        }
        header .logo-link {
            width: 35%;
            margin-left: 10%;
            margin-top: 2%;
        }
        header img{
            color: white;
            width: 100%;
            border-radius: 100px;
        }
        header img:hover{
            background-color: #7b7b7b6c;
        }
        header .promiedos{
            color: white;
            text-decoration: none;
            align-items: center;
            float: right;
            margin-right: 10%;
            margin-top: 2%;
        }
        header .promiedos:hover{
            color:aqua;
        }
        main{
            align-items: center;
        }
        form{
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 5%;
            width: 80%;
            margin-left: 10%;
            margin-right: 10%;
            background-color: rgb(31, 28, 28);
            border-radius: 25px;
            border:10px solid rgba(0,0,0,0.2);
            padding-top: 5%;
            padding-bottom: 5%;
        }
        .content-select{
        	display: flex;
            flex-direction: row;
            width: 100%;
            align-items: center;
            justify-content: center;
            margin-left: 5%;
            margin-right: 5%;
        }
        .content-select select{
        	width: 20%;
        	cursor: pointer;
          	padding: 7px 10px;
          	height: 60px;
        	background: #f0f0f0;
        	color: #7b7b7b;
        	font-size: 1em;
        	color: #999;
        	font-family: 'Quicksand', sans-serif;
        	border:2px solid rgba(0,0,0,0.2);
            border-radius: 25px;
            position: relative;
        }
         
        .content-select select:hover{
        	background: #B1E8CD;
        }
        .local{
            margin-right: 5%;
        }
        .visitante{
            margin-left: 5%;
        }
        h1{
            width: 18%;
            text-align: center;
            font-size: 25px;
            color:white;
        }
        button{
            margin-top: 5%;
            background-color: orange;
            color:white;
            font-family: 'Quicksand', sans-serif;
            font-size: 20px;
            width: 25%;
            padding-top: 2.5%;
            padding-bottom: 2.5%;
            border:2px solid rgba(0,0,0,0.2);
        }
        button:hover{
            background-color: rgb(255, 200, 97);
            
            box-shadow: 0 12px 16px 0 rgba(238, 255, 5, 0.24),0 17px 50px 0 rgba(238, 255, 5, 0.19);
        }

    </style>
</head>
<body>
    <header>
        <a class="logo-link"href="/">
            <img src="../Encabezado_DreamTeam.png" alt="Logo Dream team">
        </a>
        <a class="promiedos" href="https://www.promiedos.com.ar/" target="_blank">Que es DREAM TEAM?</a>
    </header>
    <form id="partido" onsubmit="jugarPartido(event)">
        <div class="content-select">
            <h1>Equipo Local</h1>
            <select class="local" name="local" required></select>
            <select class="visitante" name="visitante" required></select>
            <h1>Equipo Visitante</h1>
        </div>
        <button id="submit">Jugar</button>
    </form>
    <script>
        function response_received(response) {
            console.log('Response received:', response);
            return response.json();
        }

        function request_error(error) {
            console.error('Request failed:', error);
        }

        function fillForm(equipos, position) {
            const select = document.querySelector(`select[name="${position}"]`);
            select.innerHTML = '';

            equipos.forEach(equipo => {
                const option = document.createElement("option");
                option.value = equipo.id;
                option.textContent = equipo.nombre_equipo;
                select.append(option);
            });
        }

        function jugarPartido(event){
            event.preventDefault();

            const local = document.querySelector('select[name="local"]').value;
            const visitante = document.querySelector('select[name="visitante"]').value;

            const partido = {
                equipo_local_id: local,
                equipo_visitante_id: visitante
            };

            function success(data){
                console.log('Partido created:', data);
                alert("Iniciando partido...");
            }

            fetch("http://localhost:5000/crear_partido", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify(partido)
            })
                .then(response_received)
                .then(success)
                .catch(request_error);
        }


        function parse_data(data){
            const equipos = data;

            fillForm(equipos, "local");
            fillForm(equipos, "visitante");
        }


        fetch("http://localhost:5000/equipos")
            .then(response_received)
            .then(parse_data)
            .catch(request_error);

    </script>
</body>
</html>
